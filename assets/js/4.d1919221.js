(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{358:function(t,s,a){t.exports=a.p+"assets/img/tnf-embedding.46dfd0be.svg"},359:function(t,s,a){t.exports=a.p+"assets/img/gc-content-hist.5a2e1136.svg"},360:function(t,s,a){t.exports=a.p+"assets/img/gc-content-scores.cdfc9ced.svg"},371:function(t,s,a){"use strict";a.r(s);var e=a(17),i=Object(e.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"composition-module"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#composition-module"}},[t._v("#")]),t._v(" Composition module")]),t._v(" "),e("p",[t._v("Contigs assembled from reads derived from the same genome or from genomes of closely related organisms tend to display a similar sequence composition profile, assessed as tetranucleotide frequencies and GC-content. MAGpurify2 exploits this property to find contigs with outlier sequence composition profiles in relation to the rest of the genome and flag them as putative contaminants.")]),t._v(" "),e("h2",{attrs:{id:"tetranucleotide-frequencies"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tetranucleotide-frequencies"}},[t._v("#")]),t._v(" Tetranucleotide frequencies")]),t._v(" "),e("p",[t._v("Metagenomic binners use 4-mer frequencies, or tetranucleotide frequencies (TNFs), to cluster contigs into genomic bins. Whether or not two given contigs will be clustered into the same genomic bin does not depend exclusively on their TNF profiles. In most modern clustering algorithms local relationships are influenced by other data points, meaning that a given pair of contigs may end up in the same bin or not, depending on the full set contigs that is being clustered. Moreover, most binners also use sequencing coverage information in addition to TNF data to cluster contigs, which may lead to genomic bins that encompass contigs with distinct TNF profiles.")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("Genomic islands and plasmids")]),t._v(" "),e("p",[t._v("Mobile genetic elements such as genomic islands and plasmids usually have a 4-mer composition that is distinct from most of the genome, making them problematic for binning algorithms. Consequently, these elements are usually not retrieved in genomic bins "),e("sup",{staticClass:"footnote-ref"},[e("a",{attrs:{href:"#fn1",id:"fnref1"}},[t._v("[1]")])]),t._v(".")])]),t._v(" "),e("p",[t._v('To find potential contaminants with respect to the TNF profile, MAGpurify2 processes each genomic bin individually and identifies contigs that fall outside of the bin\'s "core TNF cluster". This is performed in three steps: (1) MAGpurify2 computes the TNF profile of each contig, (2) embbeds data points into a low-dimentional space using a non-linear transformation, and (3) finds the "core TNF cluster" and computes each contig score.')]),t._v(" "),e("p",[e("img",{attrs:{src:a(358),alt:"tnf-embedding"}})]),t._v(" "),e("p",[t._v("The four DNA bases (A, T, C and G) can produce "),e("eq",[e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("msup",[e("mn",[t._v("4")]),e("mn",[t._v("4")])],1),e("mo",[t._v("=")]),e("mn",[t._v("256")])],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("4^4 = 256")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"0.8141079999999999em","vertical-align":"0em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord"},[t._v("4")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.8141079999999999em"}},[e("span",{staticStyle:{top:"-3.063em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mtight"},[t._v("4")])])])])])])])]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),e("span",{staticClass:"mrel"},[t._v("=")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"0.64444em","vertical-align":"0em"}}),e("span",{staticClass:"mord"},[t._v("2")]),e("span",{staticClass:"mord"},[t._v("5")]),e("span",{staticClass:"mord"},[t._v("6")])])])])]),t._v(" distinct 4-mers, however, in a strand-independent analysis, reverse complement k-mers (eg.: "),e("code",[t._v("TTAC")]),t._v(" and "),e("code",[t._v("GTAA")]),t._v(") are redundant and should be counted as a single entity (a canonical k-mer) in order to reduce memory usage and data variance. Thus, MAGpurify2 counts the 136 canonical 4-mers ("),e("eq",[e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("mi",[t._v("k")])],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("k")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"0.69444em","vertical-align":"0em"}}),e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")])])])])]),t._v(") for each contig ("),e("eq",[e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("mi",[t._v("i")])],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("i")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"0.65952em","vertical-align":"0em"}}),e("span",{staticClass:"mord mathdefault"},[t._v("i")])])])])]),t._v(") within the bin and computes their relative frequencies as a maximum-likelihood estimation ("),e("eq",[e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("mi",[t._v("q")])],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("q")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("q")])])])])]),t._v(") of the underlying TNF profile of the sequence:")],1),t._v(" "),e("section",[e("eqn",[e("span",{staticClass:"katex-display"},[e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("msub",[e("mi",[t._v("q")]),e("mrow",[e("mi",[t._v("k")]),e("mo",{attrs:{separator:"true"}},[t._v(",")]),e("mi",[t._v("i")])],1)],1),e("mo",[t._v("=")]),e("mfrac",[e("msub",[e("mrow",[e("mi",[t._v("T")]),e("mi",[t._v("N")]),e("mi",[t._v("F")])],1),e("mrow",[e("mi",[t._v("k")]),e("mo",{attrs:{separator:"true"}},[t._v(",")]),e("mi",[t._v("i")])],1)],1),e("mrow",[e("munderover",[e("mo",[t._v("∑")]),e("mrow",[e("mi",[t._v("k")]),e("mo",[t._v("=")]),e("mn",[t._v("1")])],1),e("mn",[t._v("136")])],1),e("mtext"),e("msub",[e("mrow",[e("mi",[t._v("T")]),e("mi",[t._v("N")]),e("mi",[t._v("F")])],1),e("mrow",[e("mi",[t._v("k")]),e("mo",{attrs:{separator:"true"}},[t._v(",")]),e("mi",[t._v("i")])],1)],1)],1)],1)],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("\nq_{k,i} = \\frac{\\mathit{TNF}_{k,i}}{\\sum _{k=1}^{136}\\:\\mathit{TNF}_{k,i}}\n")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"0.716668em","vertical-align":"-0.286108em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("q")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.3361079999999999em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-left":"-0.03588em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),e("span",{staticClass:"mpunct mtight"},[t._v(",")]),e("span",{staticClass:"mord mathdefault mtight"},[t._v("i")])])])])]),e("span",{staticClass:"vlist-s"},[t._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.286108em"}},[e("span")])])])])]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}}),e("span",{staticClass:"mrel"},[t._v("=")]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2777777777777778em"}})]),e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"2.504048em","vertical-align":"-1.143718em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mopen nulldelimiter"}),e("span",{staticClass:"mfrac"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"1.36033em"}},[e("span",{staticStyle:{top:"-2.155992em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mop"},[e("span",{staticClass:"mop op-symbol small-op",staticStyle:{position:"relative",top:"-0.0000050000000000050004em"}},[t._v("∑")]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.954008em"}},[e("span",{staticStyle:{top:"-2.40029em","margin-left":"0em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),e("span",{staticClass:"mrel mtight"},[t._v("=")]),e("span",{staticClass:"mord mtight"},[t._v("1")])])])]),e("span",{staticStyle:{top:"-3.2029em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mtight"},[e("span",{staticClass:"mord mtight"},[t._v("1")]),e("span",{staticClass:"mord mtight"},[t._v("3")]),e("span",{staticClass:"mord mtight"},[t._v("6")])])])])]),e("span",{staticClass:"vlist-s"},[t._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.29971000000000003em"}},[e("span")])])])])]),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.16666666666666666em"}}),e("span",{staticClass:"mspace",staticStyle:{"margin-right":"0.2222222222222222em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathit"},[t._v("T")]),e("span",{staticClass:"mord mathit"},[t._v("N")]),e("span",{staticClass:"mord mathit"},[t._v("F")])]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.3361079999999999em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),e("span",{staticClass:"mpunct mtight"},[t._v(",")]),e("span",{staticClass:"mord mathdefault mtight"},[t._v("i")])])])])]),e("span",{staticClass:"vlist-s"},[t._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.286108em"}},[e("span")])])])])])])]),e("span",{staticStyle:{top:"-3.23em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),e("span",{staticClass:"frac-line",staticStyle:{"border-bottom-width":"0.04em"}})]),e("span",{staticStyle:{top:"-3.677em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"3em"}}),e("span",{staticClass:"mord"},[e("span",{staticClass:"mord"},[e("span",{staticClass:"mord"},[e("span",{staticClass:"mord mathit"},[t._v("T")]),e("span",{staticClass:"mord mathit"},[t._v("N")]),e("span",{staticClass:"mord mathit"},[t._v("F")])]),e("span",{staticClass:"msupsub"},[e("span",{staticClass:"vlist-t vlist-t2"},[e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.3361079999999999em"}},[e("span",{staticStyle:{top:"-2.5500000000000003em","margin-right":"0.05em"}},[e("span",{staticClass:"pstrut",staticStyle:{height:"2.7em"}}),e("span",{staticClass:"sizing reset-size6 size3 mtight"},[e("span",{staticClass:"mord mtight"},[e("span",{staticClass:"mord mathdefault mtight",staticStyle:{"margin-right":"0.03148em"}},[t._v("k")]),e("span",{staticClass:"mpunct mtight"},[t._v(",")]),e("span",{staticClass:"mord mathdefault mtight"},[t._v("i")])])])])]),e("span",{staticClass:"vlist-s"},[t._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"0.286108em"}},[e("span")])])])])])])])]),e("span",{staticClass:"vlist-s"},[t._v("​")])]),e("span",{staticClass:"vlist-r"},[e("span",{staticClass:"vlist",staticStyle:{height:"1.143718em"}},[e("span")])])])]),e("span",{staticClass:"mclose nulldelimiter"})])])])])])])],1),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TNF profile of short contigs")]),t._v(" "),e("p",[t._v("Short contigs contain a reduced number of 4-mers and therefore provide less reliable estimations of the underlying genomic TNF profile than longer contigs. This is one of the reasons why most binners filter out contigs shorter than a set threshold (usually around 2,000 bp) before clustering.")]),t._v(" "),e("p",[t._v("MAGpurify2 currently does not explicitly the length-dependent statistical uncertainty of the TNF estimation when identifying putative contaminants. However, "),e("RouterLink",{attrs:{to:"/docs/contaminant-detection.html"}},[t._v("contig length is taken into account to compute the final score of each contig")]),t._v(".")],1)]),t._v(" "),e("p",[t._v("The high dimensional 4-mer frequency data ("),e("eq",[e("span",{staticClass:"katex"},[e("span",{staticClass:"katex-mathml"},[e("math",{attrs:{xmlns:"http://www.w3.org/1998/Math/MathML"}},[e("semantics",[e("mrow",[e("mi",[t._v("q")])],1),e("annotation",{attrs:{encoding:"application/x-tex"}},[t._v("q")])],1)],1)],1),e("span",{staticClass:"katex-html",attrs:{"aria-hidden":"true"}},[e("span",{staticClass:"base"},[e("span",{staticClass:"strut",staticStyle:{height:"0.625em","vertical-align":"-0.19444em"}}),e("span",{staticClass:"mord mathdefault",staticStyle:{"margin-right":"0.03588em"}},[t._v("q")])])])])]),t._v(") is then non-linearly projected into a three dimensional space using the "),e("a",{attrs:{href:"https://umap-learn.readthedocs.io/en/latest/",target:"_blank",rel:"noopener noreferrer"}},[t._v("UMAP"),e("OutboundLink")],1),t._v(" algorithm, which will bring similar data points together and distance contigs with distinct TNF profiles. Next, "),e("a",{attrs:{href:"https://hdbscan.readthedocs.io/en/latest/",target:"_blank",rel:"noopener noreferrer"}},[t._v("hdbscan"),e("OutboundLink")],1),t._v(' is used to identify clusters within the UMAP embedding and, if at least one cluster is found, compute the membership level of each contig to the "core cluster". Here, "core cluster" is defined as the cluster that encompassess the largest assembled fraction, that is, the sum of the lengths of all the contigs within the cluster.')],1),t._v(" "),e("p",[t._v('As UMAP is a non-deterministic algorithm, MAGpurify2 executes multiple iterations of the dimension reduction and clustering steps. The final contig score corresponds to the average of its membership level to the "core cluster" across the iterations.')]),t._v(" "),e("h2",{attrs:{id:"gc-content"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#gc-content"}},[t._v("#")]),t._v(" GC content")]),t._v(" "),e("p",[t._v("A simpler descriptor of sequence composition is the GC-content, which represents the relative amount of guanine (G) and cytosine (C) relative to the total amount of nucleotides in the sequence. In prokaryotes there is a large variability in genomic GC-content across different species, which is at least partially caused by evolutionary pressures. Despite the heterogeneity in GC-content even within genomes, this measure has been successfully used for contig binning and contamint identification in situations where the underlying genomes exhibited diverging GC-content levels.")]),t._v(" "),e("p",[t._v("MAGpurify2 processes each genomic bin to find contigs")]),t._v(" "),e("p",[e("img",{attrs:{src:a(359),alt:"gc-content-hist"}})]),t._v(" "),e("p",[t._v("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam id nulla ac velit elementum tempus non eget urna. Etiam placerat leo ac risus semper feugiat ut id nulla. Fusce venenatis magna non feugiat convallis.")]),t._v(" "),e("p",[e("img",{attrs:{src:a(360),alt:"gc-content-scores"}})]),t._v(" "),e("hr",{staticClass:"footnotes-sep"}),t._v(" "),e("section",{staticClass:"footnotes"},[e("ol",{staticClass:"footnotes-list"},[e("li",{staticClass:"footnote-item",attrs:{id:"fn1"}},[e("p",[t._v("Maguire, Finlay, et al. "),e("a",{attrs:{href:"https://www.biorxiv.org/content/10.1101/2020.03.31.997171v2",target:"_blank",rel:"noopener noreferrer"}},[t._v('"Metagenome-Assembled Genome Binning Methods with Short Reads Disproportionately Fail for Plasmids and Genomic Islands."'),e("OutboundLink")],1),t._v(" "),e("em",[t._v("bioRxiv")]),t._v(" (2020). "),e("a",{staticClass:"footnote-backref",attrs:{href:"#fnref1"}},[t._v("↩︎")])])])])])])}),[],!1,null,null,null);s.default=i.exports}}]);